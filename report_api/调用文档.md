# 清洁机器人报告生成API调用文档

## 概述
此API用于生成清洁机器人的性能报告，支持灵活的位置和机器人选择条件。

## 基本信息
- **API地址**: `http://monitor-report-api-alb-1071100458.us-east-1.elb.amazonaws.com/api/reports/generate`
- **请求方法**: POST
- **Content-Type**: application/json

## 重要注意事项

### 1. 字段格式要求
- 所有字符串必须使用**双引号**，不能使用单引号
- **驼峰命名法**: 每个field（如果两个单词组成，见下面基本请求结构）第二个单词首字母大写，如 `"timeRange"`、`"reportName"`
- **timeRange**: 使用连字符，如 `"last-7-days"`、`"last-30-days"`、`"last-90-days"` （网页端提供这三种即可）， 如果是用户自定义时间短，则是 `"custom"`，并提供 `"customStartDate"`和`"customEndDate"`
- **outputFormat**: 小写，如 `"html"`、`"pdf"`

### 2. 字段名称兼容性
系统支持单数和复数字段名，会自动标准化：
- `"building"` 和 `"buildings"` 都可以
- `"name"` 和 `"names"` 都可以
- `"serialNumber"` 和 `"serialNumbers"` 都可以

### 3. 大小写容忍性
位置字段不区分大小写：
- `"us"`、`"US"`、`"Us"` 都可以
- `"fl"`、`"FL"` 都可以


## 基本请求结构

```json
{
  "database_name": "UF2", //需要网页端发送请求时提供
  "mainKey": 1, // 数据库主键 // 需要网页端发送请求时提供
  "form_data": {
    "service": "robot-management", ////网页端用户提供
    "location": { /* 位置选择 */ }, //网页端用户提供
    "robot": { /* 机器人选择 */ }, //网页端用户提供
    "contentCategories": ["charging-performance", "cleaning-performance", "resource-utilization", "financial-performance"], //网页端用户提供
    "reportName": "报告名称", //网页端用户提供
    "outputFormat": "html",  // 或 "pdf" //网页端用户提供
    "timeRange": "custom",   // 或预定义时间范围（`"last-7-days"`、`"last-30-days"`、`"last-90-days"`）//网页端用户提供
    "customStartDate": "2025-09-01",  // timeRange为custom时必填 //网页端用户提供
    "customEndDate": "2025-09-12",    // timeRange为custom时必填 //网页端用户提供
    "detailLevel": "detailed" //网页端用户提供
  }
}
```

## 位置选择方案

### 方案1：选择单个建筑物
```json
"location": {
  "country": "us",
  "state": "fl",
  "city": "gainesville",
  "building": "Building 43 Marston Science Library"
}
```

### 方案2：选择多个建筑物
```json
"location": {
  "country": "us",
  "state": "fl",
  "city": "gainesville",
  "building": ["Building 43 Marston Science Library", "Building 205 Dental Science"]
}
```
或使用复数形式：
```json
"location": {
  "country": "us",
  "state": "fl",
  "city": "gainesville",
  "buildings": ["Building 43 Marston Science Library", "Building 205 Dental Science"]
}
```

### 方案3：选择城市下所有建筑物
```json
"location": {
  "country": "us",
  "state": "fl",
  "city": "gainesville"
  // 不指定building字段，自动包含该城市所有建筑物
}
```

### 方案4：选择多个城市
```json
"location": {
  "country": "us",
  "state": "fl",
  "cities": ["gainesville", "orlando", "miami"]
}
```

### 方案5：选择多个州
```json
"location": {
  "country": "us",
  "states": ["fl", "ga", "ny"]
}
```

### 方案6：选择多个国家
```json
"location": {
  "countries": ["us", "ca"]
}
```

## 机器人选择方案

### 方案1：按机器人名称选择
```json
"robot": {
  "name": "Building_205_Dental_Science"
}
```

### 方案2：按多个机器人名称选择
```json
"robot": {
  "name": ["Building_205_Dental_Science", "Building_43_Marston_Library"]
}
```
或使用复数形式：
```json
"robot": {
  "names": ["Building_205_Dental_Science", "Building_43_Marston_Library"]
}
```

### 方案3：按序列号选择
```json
"robot": {
  "serialNumber": "811135422060216"
}
```

### 方案4：按多个序列号选择
```json
"robot": {
  "serialNumbers": ["811135422060216", "811135422060217", "811135422060218"]
}
```

### 方案5：同时使用名称和序列号
```json
"robot": {
  "names": ["Robot_A", "Robot_B"],
  "serialNumbers": ["SN123456", "SN789012"]
}
```

## 组合选择方案

### 方案1：位置 + 机器人名称组合
```json
{
  "location": {
    "state": "fl",
    "city": "gainesville"
  },
  "robot": {
    "names": ["Building_205_Dental_Science"]
  }
}
```
**说明**: 只返回在gainesville同时和名称匹配的机器人

## 时间范围选项

### 预定义时间范围
```json
"timeRange": "last-7-days"    // 最近7天
"timeRange": "last-30-days"   // 最近30天
"timeRange": "last-90-days"   // 最近90天
```

### 自定义时间范围
```json
"timeRange": "custom",
"customStartDate": "2025-09-01", // 如果自定义需要提供开始日期
"customEndDate": "2025-09-12" // 如果自定义需要提供结束日期
```

## 输出格式选项

```json
"outputFormat": "html"  // HTML格式
"outputFormat": "pdf"   // PDF格式
```

## 详细程度选项

```json
"detailLevel": "overview"   // 概览
"detailLevel": "detailed"   // 详细
"detailLevel": "in-depth"   // 深度分析
```

## 内容类别选项

```json
"contentCategories": [
  "cleaning-performance",   // 清洁性能
  "charging-performance",   // 充电性能
  "resource-utilization",   // 资源利用率
  "financial-performance"   // 财务绩效
]
```

## 完整示例

### 示例1：单个建筑物HTML报告
```bash
curl -X POST http://monitor-report-api-alb-1071100458.us-east-1.elb.amazonaws.com/api/reports/generate \
  -H "Content-Type: application/json" \
  -d '{
    "customer_id": "UF2",
    "mainkey": 1,
    "form_data": {
      "service": "robot-management",
      "location": {
        "country": "us",
        "state": "fl",
        "city": "gainesville",
        "building": "Building 43 Marston Science Library"
      },
      "contentCategories": ["charging-performance", "cleaning-performance", "resource-utilization", "financial-performance"],
      "reportName": "UF单建筑物报告",
      "outputFormat": "html",
      "timeRange": "custom",
      "customStartDate": "2025-09-01",
      "customEndDate": "2025-09-12",
      "detailLevel": "detailed"
    }
  }'
```

### 示例2：多个建筑物报告
```bash
curl -X POST http://monitor-report-api-alb-1071100458.us-east-1.elb.amazonaws.com/api/reports/generate \
  -H "Content-Type: application/json" \
  -d '{
    "database_name": "UF2",
    "mainkey": 1,
    "form_data": {
      "service": "robot-management",
      "location": {
        "country": "us",
        "state": "fl",
        "city": "gainesville",
        "buildings": ["Building 43 Marston Science Library", "Building 205 Dental Science"]
      },
      "contentCategories": ["charging-performance", "cleaning-performance", "resource-utilization", "financial-performance"],
      "reportName": "UF多建筑物报告",
      "outputFormat": "html",
      "timeRange": "custom",
      "customStartDate": "2025-09-01",
      "customEndDate": "2025-09-12",
      "detailLevel": "detailed"
    }
  }'
```

### 示例3：按机器人名称生成PDF报告
```bash
curl -X POST http://monitor-report-api-alb-1071100458.us-east-1.elb.amazonaws.com/api/reports/generate \
  -H "Content-Type: application/json" \
  -d '{
    "database_name": "UF2",
    "mainkey": 1,
    "form_data": {
      "service": "robot-management",
      "robot": {
        "names": ["Building_205_Dental_Science", "Building_43_Marston_Library"]
      },
      "contentCategories": ["charging-performance", "cleaning-performance", "resource-utilization", "financial-performance"],
      "reportName": "UF机器人报告",
      "outputFormat": "pdf",
      "timeRange": "last-7-days",
      "detailLevel": "detailed"
    }
  }'
```

### 示例4：按序列号生成报告
```bash
curl -X POST http://monitor-report-api-alb-1071100458.us-east-1.elb.amazonaws.com/api/reports/generate \
  -H "Content-Type: application/json" \
  -d '{
    "database_name": "UF2",
    "mainkey": 1,
    "form_data": {
      "service": "robot-management",
      "robot": {
        "serialNumber": "811135422060216"
      },
      "contentCategories": ["charging-performance", "cleaning-performance", "resource-utilization", "financial-performance"],
      "reportName": "UF单机器人报告",
      "outputFormat": "pdf",
      "timeRange": "last-7-days",
      "detailLevel": "detailed"
    }
  }'
```

## 错误处理

### 常见错误
1. **字段格式错误**: 确保使用双引号，驼峰命名正确
2. **时间范围错误**: custom时间范围必须提供开始和结束日期
3. **位置不存在**: 指定的位置在数据库中找不到
4. **机器人不存在**: 指定的机器人名称或序列号不存在

### 成功响应示例 - 网页端可以不查验
```json
{"success":true,
"request_id":"df14fa3c-1538-43d5-bc2f-5bc7350a434a",
"message":"HTML report generation started",
"status":"queued"}
```

### 错误响应示例
```json
{
  "success": false
}
```

## 开发提示

1. **日期格式**: 自定义日期必须使用 `YYYY-MM-DD` 格式
2. **字段验证**: 发送请求前检查所有必填字段


## 技术支持

如遇到问题，请检查：
1. JSON格式是否正确
2. 字段名称拼写是否正确
3. 数据类型是否匹配
4. 必填字段是否完整